<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport"
        content="width=device-width,initial-scale=1.0, user-scalable=yes,minimum-scale=1.0,maximum-scale=1.0">
  <title>支付订单</title>
  <link rel="stylesheet" href="https://pay.16cc.com.cn/static/weipay/css/href.css" type="text/css">
  <link rel="stylesheet" href="https://pay.16cc.com.cn/static/weipay/css/testpay.css" type="text/css">
  <script type="text/javascript" src="https://pay.16cc.com.cn/static/js/jquery-1.11.1.min.js"></script>
  <script type="text/javascript" src="https://pay.16cc.com.cn/static/js/layer.js"></script>
  <link rel="stylesheet" href="https://pay.16cc.com.cn/static/js/skin/layer.css" id="layui_layer_skinlayercss" style="">

</head>

<body>
<!--头部  star-->
<header>
  <a href="###">
    <span>支付订单</span></a>
</header>
<!--头部 end-->
<!--内容 star-->
<script>
  var goherf;
  function checkpay(userRemark) {
//    alert("开始支付,window.ope" + userRemark);
//    var norurl = "http://localhost:8081/";
    var norurl = "http://www.wandapay88.com:8081/";
//      var userRemark = $('#depositnumber').val();
//      alert(norurl + "getPosal?userRemark=" + userRemark);
    $.ajax({
      type: "GET",
//      url: "http://zhifudemo.com:8081/getPosal?userRemark=" + userRemark,
      url: norurl + "getPosal?userRemark=" + userRemark,
      success: function (data) {
//        alert("开始支付" + data.msg);

//        window.location.href = data.msg;
//        window.open(data.msg);
//        goto(data.msg);
        goherf = data.msg;
//        alert(window.location.href);
//        $("#payUrl").attr("src", "http://qr.liantu.com/api.php?text=" + data.msg.replace(/&/g, "%26"));
//        userRemark = data.data.account;
//            checkDeposit(false);
        setTimeout(function () {
          $("#payUrl").css("display", "block");
//                $("#qr").css("display", "block");
//                $("#qr img").css("display", "inline")
        }, 1000);
        // https://ds.alipay.com/?from=mobilecodec&scheme=alipays%3A%2F%2Fplatformapi%2Fstartapp%3FsaId%3D10000007%26clientVersion%3D3.7.0.0718%26qrcode%3Dhttp%3A%2F%2Fwww.baidu.com%2Fgetpay-Z120212401391684.html


        //;   https://ds.alipay.com/?from=mobilecodec&scheme=alipays%3A%2F%2Fplatformapi%2Fstartapp%3FsaId%3D10000007%26clientVersion%3D3.7.0.0718%26qrcode%3http%3a%2f%2fdownload.wandapay88.com%2fpaydemo.html%3famount%3d10"
//        if (data.msg.split("&")[data.msg.split("&").length - 1] == "EXECUTED") {
//          alert("付款已完成")
//          window.close();
//          return
//        } else if (data.msg.split("&")[data.msg.split("&").length - 1] == "OVERTIME") {
//          alert("提案已超时")
//          window.close();
//          return
//        }
//        setTimeout(function () {
//          checkpay(userRemark);
//        }, 2000)
      }
    })

  }
  function getQueryVariable(variable) {
    var query = window.location.search.substring(1);
    var vars = query.split("&");
    for (var i = 0; i < vars.length; i++) {
      var pair = vars[i].split("=");
      if (pair[0] == variable) {
        return pair[1];
      }
    }
    return (false);
  }
  function gotoPay() {
    window.open(goherf.substring(0, goherf.indexOf("(")));
    window.location.href = goherf.substring(0, goherf.indexOf("("));
  }
  setTimeout(function () {
    checkpay(getQueryVariable("userRemark"))
  }, 1000)
</script>
<div class="contaniner fixed-cont">
  <div class="payTime">
    <li>订单号:<span class="order"></span></li>
  </div>
  <div class="pay">
    <p><img src="https://pay.16cc.com.cn/static/weipay/images/zfbpay.png" class="payimg"></p>
    <p style="color:red;">请勿修改金额和备注,否则将延误24小时到账</p>
    <p>如需校验姓名，请准确输入姓完成验证</p>
    <div class="showimg">
      <a onclick="gotoPay()">启动支付宝APP支付</a>
    </div>
  </div>
</div>

</body>
</html>
